<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Foo Bar</title>
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" type="text/css" href="custom.css" />
  </head>
  <body>
    <header>
      <nav class="navbar navbar-expand-md navbar-dark fixed-top bg-dark">
        <div class="container-fluid">
          <a class="navbar-brand fw-bold" href="#">Foo Bar</a>
          <button
            class="navbar-toggler"
            type="button"
            data-bs-toggle="collapse"
            data-bs-target="#navbarCollapse"
            aria-controls="navbarCollapse"
            aria-expanded="false"
            aria-label="Toggle navigation"
          >
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav me-auto mb-2 mb-md-0">
              <li class="nav-item">
                <a class="nav-link active" aria-current="page" href="#">Home</a>
              </li>
              <li class="nav-item">
                <a class="nav-link" href="https://github.com/MaximParker"
                  >GitHub</a
                >
              </li>
              <li class="nav-item">
                <a
                  class="nav-link"
                  href="https://www.linkedin.com/in/max-parker-196a35227/"
                  >LinkedIn</a
                >
              </li>
            </ul>
            <form class="d-flex" id="login">
              <input
                id="loginInput"
                class="form-control me-2"
                type="input"
                placeholder="Username..."
                aria-label="login"
              />
              <button class="btn btn-outline-success" type="submit">
                Apply
              </button>
            </form>
          </div>
        </div>
      </nav>
    </header>

    <main>
      <div>
        <div class="maintxt">
          <h1 id="welcome-text">Welcome</h1>
        </div>
      </div>

      <div class="container marketing">
        <div class="row mt-4">
          <div class="col-lg-4">
            <h2 class="fw-normal">Find a Pokémon</h2>
            <form id="getPokemon" class="">
              <div class="form-group">
                <div id="APIResponse"> </div>
                <br/>
                <input
                  type="text"
                  placeholder="ID number..."
                  id="inputBox"
                  class="form-control me-2"
                />
                <br />
                <button id="getRequest" type="submit" class="btn btn-outline-success">
                  Get &raquo;
                </button>
            </form>
          </div>
        </div>
        
        <div class="col-lg-4">
          <h2 class="fw-normal">Lorem ipsum</h2>
          <p>
            Vestibulum ante ipsum primis in faucibus orci luctus et ultrices
            posuere cubilia Curae; Donec velit neque, auctor sit amet aliquam
            vel, ullamcorper sit amet ligula. Donec rutrum congue leo eget
            malesuada. Proin eget tortor risus.
          </p>
        </div>
        <div class="col-lg-4">
          <h2 class="fw-normal">Dolor sit amet</h2>
          <p>
            Cras ultricies ligula sed magna dictum porta. Pellentesque in
            ipsum id orci porta dapibus. Nulla porttitor accumsan tincidunt.
            Mauris blandit aliquet elit, eget tincidunt nibh pulvinar a. Donec
            rutrum congue leo eget malesuada. Vivamus magna justo, lacinia
            eget consectetur sed, convallis at tellus. Nulla quis lorem ut
            libero malesuada feugiat.
          </p>
        </div>
        <div class="col-lg-4">
          <h2 class="fw-normal">Dolor sit amet</h2>
          <p>
            Cras ultricies ligula sed magna dictum porta. Pellentesque in
            ipsum id orci porta dapibus. Nulla porttitor accumsan tincidunt.
            Mauris blandit aliquet elit, eget tincidunt nibh pulvinar a. Donec
            rutrum congue leo eget malesuada. Vivamus magna justo, lacinia
            eget consectetur sed, convallis at tellus. Nulla quis lorem ut
            libero malesuada feugiat.
          </p>
        </div>
      </div>

      <hr />

      <script>
        const userData = localStorage.getItem('username');
        console.log(userData)
        if (userData) {
          document.getElementById("welcome-text").innerHTML = `Welcome, ${userData}!`
        }

        document
          .getElementById("login")
          .addEventListener("submit", function(event) {
            setUsername(document.getElementById("loginInput").value);
            document.getElementById("welcome-text").innerHTML = `Welcome, ${userData}!`
        })

        function setUsername(x) {
          localStorage.setItem('username', x.toString());
        }

        document
          .getElementById("getPokemon")
          .addEventListener("submit", function(event) {
            event.preventDefault();
            fetchPokemon(document.getElementById("inputBox").value)
        })
        
        function isNumeric(str) {
          if (typeof str != "string") return false // we only process strings!  
            return !isNaN(str) && // use type coercion to parse the _entirety_ of the string (`parseFloat` alone does not do this)...
            !isNaN(parseFloat(str)) // ...and ensure strings of whitespace fail
        }

        function fetchPokemon(x) {
          let errorMessage = "Pokémon not found. Please enter a valid ID number."
          if (isNumeric(x)) {
            document.getElementById("APIResponse").innerHTML = "Loading..."
            fetch(`https://pokeapi.co/api/v2/pokemon/${x}`)
            .then((res) => res.json())
            .then((data) => {
              console.log(data);
              let formattedData = `#${x}: ${data.name[0].toUpperCase() + data.name.substring(1)}`;
              document.getElementById("APIResponse").innerHTML = formattedData;
            })
            .catch(
              (err) => (document.getElementById("APIResponse").innerHTML = errorMessage)
            );
          }
          else {
            document.getElementById("APIResponse").innerHTML = errorMessage
          }
        }
      </script>

      <footer class="container">
        <p class="float-end"><a href="#">Back to top</a></p>
        <p>
          MaximParker &copy; 2022
        </p>
      </footer>
    </main>

    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
